# === 基础服务 ===
DATABASE_URL=postgresql+psycopg://medpol:medpol@localhost:5432/medpol
REDIS_URL=redis://localhost:6379/0

# === AI 对话（Vanna 单栈） ===
AI_CHAT_PROVIDER=ollama        # ollama | openai | deepseek
AI_CHAT_MODEL=llama3
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o
DEEPSEEK_API_KEY=
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_BETA_URL=https://api.deepseek.com/beta
DEEPSEEK_MODEL=deepseek-chat
AI_PRIMARY=ollama
AI_STRICT_MODE=false
AI_JSON_FALLBACK=true

# Ollama（聊天与向量化）
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_CHAT_MODEL=llama3
OLLAMA_EMBEDDING_MODEL=bge-m3

# === RAG / 向量检索（pgvector） ===
PGVECTOR_COLLECTION_NAME=medpol_articles
PGVECTOR_EMBEDDING_DIMENSION=1024
MEMORY_WINDOW=30
MEMORY_TTL_MINUTES=4320

# === 格式化配置 ===
FORMATTER_SEEN_PATH=sample_data/state/formatter_seen.json

# === 财务数据同步（scripts/sync_finance_data.py） ===
FINANCE_API_BASE_URL=http://ailianhuan.xyz:8333
FINANCE_API_TIMEOUT=30
FINANCE_DATA_ENDPOINT=http://ailianhuan.xyz:8333/financeDate/dataList

# === Admin Portal / API Gateway ===
VITE_API_BASE=http://localhost:8000

# === Public Chat 独立 API 地址（可选）===
# 如果 public_chat 部署在不同网络环境，设置此变量
# 例如：内网部署时使用内网 IP，公网部署时使用公网域名
VITE_PUBLIC_CHAT_API_BASE=

# 示例：
# VITE_PUBLIC_CHAT_API_BASE=http://192.168.1.100:8000  # 内网部署
# VITE_PUBLIC_CHAT_API_BASE=https://chat.example.com   # 公网部署

LOG_FILE_PATH=test.log
ADMIN_PORTAL_ORIGINS=http://localhost:4173,http://127.0.0.1:4173

# === 嵌入式聊天认证（admin_portal 专用）===
# admin_portal 的 EmbedChat 使用此 token（统一 token，mode-based 角色分配）
# 建议：设置一个强随机值，保护 admin_portal 的嵌入式聊天功能
# 留空则所有 token 都走访问码映射逻辑（开发模式）
EMBED_AUTH_TOKEN=

# === 公开对话页面访问码（public_chat）===
VITE_ACCESS_CODE=nature@lianhuan

# === 访问码角色映射（public_chat 后端）===
# 格式：code1:role1,code2:role2
# 角色可选值：viewer, admin, finance
# 示例：ACCESS_CODE_ROLES=nature@lianhuan:viewer,admin@lianhuan:admin,finance@lianhuan:finance
ACCESS_CODE_ROLES=

# 说明：
# - EMBED_AUTH_TOKEN（admin_portal）：使用 mode 参数决定角色
#   - mode=hybrid → admin（政策 + 员工敏感信息 + 财务数据）
#   - mode=sql    → finance（仅财务数据）
#   - mode=rag    → viewer（政策 + 员工基础信息）
#
# - ACCESS_CODE_ROLES（public_chat）：使用访问码映射角色
#   - nature@lianhuan  → viewer（政策查询 + 员工基础信息，不含 phone/id_number）
#   - admin@lianhuan   → admin（政策查询 + 员工敏感信息 + 财务数据）
#   - finance@lianhuan → finance（仅财务数据查询）
#   - 未配置的访问码默认为 viewer 角色
#
# 两者完全隔离：
# - admin_portal 使用 EMBED_AUTH_TOKEN（保持 mode-based 行为）
# - public_chat 使用 ACCESS_CODE_ROLES 映射（新功能）

# === 爬虫运行参数 ===
NMPA_REMOTE_CDP_URL=http://localhost:9222